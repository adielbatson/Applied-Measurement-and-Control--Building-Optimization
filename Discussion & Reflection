A. Batson (28067), A. Akuri (29630), G. Ciobanu (29427)

====== Building Energy-Use Optimization ======
**A protoype to heating and lighting management**.
------
==== 1.0 Introduction =====
As the urgency to mitigate and combat climate change grows, more and more solutions are required to forder a more sustainable world. On the radar for these solutions, energy conservation and consumption reduction techniques comprise a significant measure in realizing greater sustainability in home & industry (Mahiri et al. 2022). However, one of the greatest limitations in realizing these developments is human contingent, for example forgetting to turn/off lights and heating. This project targets energy-use optimization by smart control of lights and heating use in prototye designed to simplify a room in a building.  

The 'brains' of this project will be the ESP32 microcontroller. This inexpensive controller is a great fit for the project due to its ability to handle different types of sensors and later tramsit data values to databases via WiFi, where observations and monitoring can be remotely controlled. 

An LDR photo resistor takes light value data. Depending on threshold values LEDs will be turned on and off so that natural light utilization will be more when conditions outside are bright. A DHT11 sensor works similarly, in taking room temperature data, which determine the switching on/off of a ventilator, used to represent an AC unit. 
----
==== 2.0 Materials & Method ====  

=== 2.1 Materials & Software ===
  *  Arduino UNO 
  *  ESP32 Connection & MQTT
  *  LDR Photoresistor
  *  DHT11 Temperature Sensor
  *  SPDT Relay
  * RTC Real time Clock

  

  *  Node-Red
  *  InfluxDB
  *  Grafana
(Text in this section can be hyperlinked)


=== 2.1.1 ESP32 & Wi-Fi Connection ===

The ESP32 is a special microcontroller. They pack an outstanding 2.4GHz Wi-Fi and Bluetooth combined system chip which is also designed with ultra low power consumption technology. It has quite a few other interesting benefits for optimum functionability and RF performance. It is robust, versatile and reliable within a wide array of scenarios and uses. Some of the interesting things you can use ESP32 for are building web servers, it comes with classic and also low energy Bluetooth, the LoRa technology, it can work with MQTT and even remote control a car robot among many other things (Espressif Systems, ESP32 Series Datasheet).

{{:amc2022:groupd:esp32_pin_config.png?400|}}
| **//Figure 1//**  Schematic of the ESP32 Dev Module Micro-controller.  |
=== 2.1.2 LDR Photoresistor ===
**|Purpose|**
A Photoresistor Light dependent resistor (LDR) is an electronic device which is used in an electronic circuit to detect and measure the presence and level of light intensity.
These LDRs are specifically designed for the purpose of light sensitivity detection and the change in the resistance this creates, which differentiates them from other resistors like the carbon film resistor or the metal oxide film resistor, hence increasing their importance in an electrical circuit.

**|Applicability|**
The LDR comes with a lot of advantages; it is cheap, readily available, easy to use and also easy to manufacture. They are made from semiconductor materials allowing them to have light sensitive properties. The simple structure and labeled parts of an LDR can be seen in figure 1.

{{:amc2022:groupd:ldr_photoresistor.png?400|}}
| **//Figure 2//** [[https://engineeringlearn.com/what-is-ldr-photoresistor-types-working-application-diagram-symbol-complete-details/|     LDR Photoresistor]].  |


**|Functioning|**
The way the LDR works is simple. When light makes contact with the upper surface it cause a change in resistance. This resistance is measured in Ohms.

**|Assimilation|**
For our project, we recalibrated the LDR with a luxmeter to obtain values in lux, which we thought was a better unit to apply to  visualize the light readings of the project. Compared to ohms it felt more intuitive. The relationship between the readings of Ohms and Lux was assumed to be linear. This development is annotated in the code in teh `Results` section of the document.

=== 2.1.3 DHT11 Temperature Sensor ===


The DHT11 it is a simple effective but inexpensive temperature and humidity sensor. It is made up of features that measure analog signals and converts them into temperature and humidity values. This means they are quite intuitive and easy to connect to a microcontroller. Amongst all these benefits, it also is a lower power consumption device and has reliable long term stability. (D. Srivastava et. al. 2018)


{{:amc2022:groupd:dht_11.png?400|}}
**//Figure 2//** [[https://engineeringlearn.com/what-is-ldr-photoresistor-types-working-application-diagram-symbol-complete-details/|     LDR Photoresistor]].

**Specifications** 
  * Temperature range: 0 to 50ºC +/- 2ºC
  * Relative humidity range: 20 to 90% +/-5%
  * Temperature resolution: 1ºC
  * Humidity resolution: 1%
  * Operating voltage: 3 to 5.5 V DC
  * Current supply: 0.5 to 2.5 mA
  * Sampling period: 1 second


=== 2.1.4  SPDT Relay ===
=== 2.1.5 Software Packages === 

The programming tool Node-Red that uses a browser-based flow editor to wire together hardware devices, APIs and online services.
InfluxDB is a time series database built specifically for storing time series data. It was used along with Grafana.
Grafana is a time series data visualization tools.It provides charts, graphs, and alerts for the web when connected to supported data sources.


=== 2.2 Method ===

In the beginning of the project, many of the sensors and tools were clearly used, and parts were missing from the kit. In order to confirm the functionality of the sensors and the microcontrollers, as well as wires and resistors, we set out to test individual components with the arduino UNO board and esp32 board. The idea behind was to able the streamlining of debugging by narrowing the troubleshooting efforts required later when using the esp32.

=== 2.3 Pre-testing Phase === 
All pretesting was conducted with Arduino UNO as it was a more familiar controller, with familiar ports and specifications. 

== 2.3.1 DHT 11 x ESP32 ==
 
{{ :amc2022:groupd:dht_avec_arduino_uno.png?200 |}}
''https://www.bastelgarage.ch/image/catalog/Blog/1_DHT11/20160425-DHT11_V1.0_Steckplatine.jpg''
== Code ==

== 2.3.2 LDR Photoresistor x Arduino UNO ==
For the Setup, a 10k Ohm resistor was paired to the resistor on a breadboard fed by arduino UNO. It was found that the components were working responsively. 

**Schematic**

**Code**
<file c++ Photoresistor Testing>
/* Here the LDR photoresistor is tested with arduino.
   2 LEDs are paired to the different light values to simulate an indoor response to sunny, 
   overcast, and dark natural lighting conditions
   The application of further development of this test could be useful in vertical farming systems 
   and smart lighting services for industrial buildings/homes with many windows and architectural utilization/
   reliance on natural light.
*/
int light = 0; // store current light value

void setup() {
  Serial.begin(9600);
  pinMode(13, OUTPUT); // setting LEDs to visualize changes in lighting in the given pin IDs.
  pinMode(12, OUTPUT);

}

void loop() {

  light = analogRead(A0); // read the light value from the LDR photoresistor.
  Serial.println(light);

  if (light > 450) {  // when its bright (i.e greater than 450Ohms), both LEDs will be off to save eergy)
    Serial.println("It very bright, lots of natural light");
    digitalWrite(13, LOW);
    digitalWrite(12, LOW); 
  }

  else if (light > 229 && light < 451) { //medium amount of light to show one LED at a time).
    Serial.println("moderate light quantity, quite cloudy");
    digitalWrite(13, HIGH);
    digitalWrite(12,LOW);
  }
  else { // both LEDs turn on when the surroundings are dark.
    Serial.println("It very dark, extremely overcast or night time");
    digitalWrite(13, HIGH);
    digitalWrite(12, HIGH);
  }
 delay(750);
</file>
 

<html>
<div class="tenor-gif-embed" data-postid="7268918" data-share-method="host" data-width="100%" data-aspect-ratio="1.761904761904762"><a href="https://tenor.com/view/walking-dead-easy-easy-peasy-lemon-squeazy-gif-7268918">Walking Dead Easy GIF</a> from <a href="https://tenor.com/search/walkingdead-gifs">Walkingdead GIFs</a></div><script type="text/javascript" async src="https://tenor.com/embed.js"></script>
</html>


----
==== 3.0 Results of Combining the Codes, MQTT & NIG ====
== 3.1 Schematics ==

== 3.2 Code ==

== 3.3 Serial Monitor, Graphana and Node-Red ==
==== 4.0 Discussion ====

==== 5.0 Literature References ====
Mahiri, F., Najoua, A., & Ben Souda, S. (2022). 5G-Enabled IIoT Framework Architecture Towards Sustainable Smart Manufacturing. In International Journal of Online & Biomedical Engineering; 2022, Vol (Bd. 16, Nummer 4, S. 4–20). https://doi.org/10.3991/ijoe.v18i04.27753

 D. Srivastava, A. Kesarwani, S. Dubey(2018) Measurement of Temperature and Humidity by using Arduino Tool and DHT11 Department of Computer Applications, JSS Academy of Technical Education, Noida, India
